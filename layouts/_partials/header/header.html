{{- $header := .Site.Params.header }}
<header x-data="{sideNav: false, atTop: true}" class="header relative">
    <div class="nav z-50 bg-dark-primary"
        :class="{ 'absolute w-full left-0 top-0 z-40': atTop, 'fixed w-full left-0 top-0 transition-all duration-200 ease-[ease] shadow-lg z-50': !atTop }"
        x-on:scroll.window="atTop = (window.pageYOffset > 200) ? false : true;">
        <div
            class="nav__container container w-full lg:max-w-screen-lg xl:max-w-screen-xl mx-auto relative px-5 xl:px-0 py-4.5">
            <div class="nav__wrapper h-11.5 lg:h-11.5 flex items-center justify-between gap-9">
                <div class="nav__brand logo w-[169px] flex-none">
                    <a class="navbar__logo text-darkblack text-[2.125rem] font-bold font-body leading-normal outline-none"
                        href="{{ "/" | relURL }}" title="{{ $header.title }}">
                        <span class="block">
                            {{- partial "svg/main-logo.svg" (dict "class" "w-full h-auto")}}
                        </span>
                    </a>
                </div>
                <div class="flex-1 flex items-center justify-between">
                    <div x-cloak class="nav__menu flex-1 fixed lg:static w-full h-screen lg:h-auto left-0 top-0 transition-all duration-300 ease-[ease] z-20 bg-[#3A3A3A]/10 lg:bg-transparent"
                        :class="sideNav ? 'visible opacity-100' : 'invisible lg:visible opacity-0 lg:opacity-100'">
                        <nav x-data="{ selectedMenu: null, dropdownMenu: false }"
                            class="navbar w-full bg-white lg:bg-transparent relative transition-all duration-300 ease-[ease] origin-top text-center pt-[70px] lg:pt-0 pb-13 lg:pb-0 rounded-b-[36px]"
                            :class="sideNav ? 'opacity-100 translate-y-0' : 'opacity-0 lg:opacity-100 -translate-y-4 lg:translate-y-0'">
                            <div class="lg:flex lg:justify-between lg:items-center">
                                <ul
                                    class="navbar__menu menu lg:flex lg:items-center list-none mb-0 lg:pl-4.5 lg:border-l border-l-white/40">
                                    {{- $currentPage := . }}
                                    {{- range $index, $menus := .Site.Menus.main }}
                                    {{- $menuURL := .URL | absLangURL }}
                                    {{- $pageURL:= $currentPage.Permalink | absLangURL }}
                                    {{- $active := eq $menuURL $pageURL }}
                                    <li @click="selectedMenu !== {{ $index }} ? selectedMenu = {{ $index }} : selectedMenu = null"
                                        class="menu__item relative group text-black lg:text-white hover:text-primary text-base font-medium font-body text-center lg:text-left leading-none lg:leading-none mb-6 lg:mb-0 z-30">
                                        {{- if .HasChildren }}
                                        <span
                                            class="w-full flex items-center justify-between lg:justify-start text-current cursor-pointer focus:outline-none">
                                            {{- .Name }}
                                            <svg class="svg-inline--fa fa-angle-down fa-w-10 fa-2x w-3 h-3 transition duration-300 ease-in-out transform lg:group-hover:-rotate-180 ml-2"
                                                :class="{'-rotate-90': selectedMenu === {{ $index }} }"
                                                aria-hidden="true" focusable="false" data-prefix="far"
                                                data-icon="angle-down" role="img" xmlns="http://www.w3.org/2000/svg"
                                                viewBox="0 0 320 512">
                                                <path fill="currentColor"
                                                    d="M151.5 347.8L3.5 201c-4.7-4.7-4.7-12.3 0-17l19.8-19.8c4.7-4.7 12.3-4.7 17 0L160 282.7l119.7-118.5c4.7-4.7 12.3-4.7 17 0l19.8 19.8c4.7 4.7 4.7 12.3 0 17l-148 146.8c-4.7 4.7-12.3 4.7-17 0z"
                                                    class=""></path>
                                            </svg>
                                        </span>
                                        <ul class="submenu whitespace-nowrap list-none bg-white lg:w-52 top-full transition-all duration-200 ease-[ease] transform origin-top z-10 lg:shadow-md lg:rounded-lg py-3 pl-0 mt-1 mb-0"
                                            :class="selectedMenu === {{ $index }} ? 'static visible scale-y-100 opacity-100' : 'absolute invisible lg:group-hover:visible scale-y-0 lg:group-hover:scale-y-100 opacity-0 lg:group-hover:opacity-100'"
                                            aria-hidden="true">
                                            {{- range .Children }}
                                            {{- $childURL := .URL | absLangURL }}
                                            {{- $active := eq $childURL $pageURL }}
                                            <li class="submenu__item {{ if $active }}submenu-active{{ end }}">
                                                <a class="submenu__item-link text-darkblack font-body font-normal leading-normal {{ if $active }}
                                            active
                                        {{- end -}}" {{ if findRE `^http` .URL }} target="_blank" rel="noopener" {{ end
                                                    }} href="{{- if findRE `^#` .URL -}}
                                            {{- if not $.IsHome -}}
                                            {{- site.Home.RelPermalink -}}
                                            {{- end }}
                                            {{- .URL -}}
                                        {{- else -}}
                                            {{- .URL | relLangURL -}}
                                        {{- end -}}">
                                                    {{ .Name }}
                                                </a>
                                            </li>
                                            {{- end }}
                                        </ul>
                                        {{- else }}
                                        <a {{ if findRE `^#` .URL }}@click="sideNav = false" {{ end }}
                                            class="menu__item-link text-current inline-block px-6 lg:px-4.5 py-1 {{ if $active }}active{{- end }} transition-all duration-300 ease-in-out"
                                            {{ if findRE `^http` .URL }} target="_blank" rel="noopener" {{ end }} href="{{- if findRE `^#` .URL -}}
                                    {{- if not $.IsHome -}}
                                    {{- site.Home.RelPermalink -}}
                                    {{- end }}{{- .URL -}}
                                {{- else -}}
                                    {{- .URL | relLangURL -}}
                                {{- end -}}">{{ .Name }}</a>
                                        {{- end }}
                                    </li>
                                    {{- end }}
                                </ul>
                                {{/*  <div class="flex justify-center">
                                    <a class="w-[121px] h-10.5 lg:h-11.5 flex justify-center items-center rounded-[14px] text-base text-black lg:text-white hover:text-primary font-body font-semibold border border-black lg:border-white hover:border-primary"
                                        href="#join-now">Join Renao</a>
                                </div>  */}}
                            </div>
                        </nav>
                    </div>
                </div>
                <div class="nav__toggle w-10 flex-none flex items-center justify-end lg:hidden">
                    <button @click="sideNav = !sideNav" name="menu"
                        class="cursor-pointer border-none outline-none focus:outline-none focus:bg-transparent transition-all duration-300 ease-[ease] z-30"
                        :class="sideNav === true ? 'text-black' : 'text-white'">
                        <svg class="fill-current transition duration-300 ease-in-out transform" width="22" height="24">
                            <line class="stroke-current stroke-2 transition duration-500 ease-in-out transform"
                                :class="{ 'translate-x-1.5 translate-y-0 rotate-45': sideNav === true }" id="top" x1="0"
                                x2="22" y1="6" y2="6"></line>
                            <line class="stroke-current stroke-2 transition duration-500 ease-in-out transform"
                                :class="{ 'opacity-0': sideNav === true }" id="middle" x1="0" x2="22" y1="12" y2="12">
                            </line>
                            <line class="stroke-current stroke-2 transition duration-500 ease-in-out transform"
                                :class="{ '-translate-x-[11px] translate-y-[7px] -rotate-45': sideNav === true }"
                                id="bottom" x1="0" x2="22" y1="18" y2="18"></line>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
</header>